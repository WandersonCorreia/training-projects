# ğŸ•’ AutomaÃ§Ã£o de MarcaÃ§Ã£o de Ponto

Este projeto foi desenvolvido com o objetivo de automatizar a marcaÃ§Ã£o do ponto eletrÃ´nico na empresa onde trabalho. AlÃ©m disso, serve como exercÃ­cio prÃ¡tico para o meu treinamento em Python, incorporando funcionalidades adicionais como abertura de programas, manipulaÃ§Ã£o de arquivos json, controle de execuÃ§Ã£o por perÃ­odo do dia e envio de SMS.

## ğŸ“ Estrutura do Projeto
.
â”œâ”€â”€ everyday.py              # Script principal que executa a rotina de automaÃ§Ã£o
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ list_programs.json   # Lista de programas a serem abertos
â”‚   â”œâ”€â”€ controle_execucao.json  # Registro de execuÃ§Ãµes por perÃ­odo
â”‚   â””â”€â”€ automacao.log        # Arquivo de log gerado pela automaÃ§Ã£o
|   â””â”€â”€ sms.log              # Arquivo de configuacao do SMS
â””â”€â”€ apps/
|   â”œâ”€â”€ navegador.py         # AutomaÃ§Ã£o via Selenium para marcar o ponto
|   â”œâ”€â”€ helpers.py           # FunÃ§Ãµes auxiliares: logging e verificaÃ§Ã£o de processos
|   â”œâ”€â”€ controle.py          # Controle de execuÃ§Ã£o por perÃ­odo
|   â”œâ”€â”€ diversos.py          # Abertura de programas com base em arquivo JSON
|   â””â”€â”€ config.py            # ConfiguraÃ§Ã£o do sistema de logging
|   â””â”€â”€ sms.py               # envio de SMS com resultado da automacao 

## âš™ï¸ Funcionalidades

- âœ… MarcaÃ§Ã£o de ponto eletrÃ´nico via automaÃ§Ã£o com Selenium
- âœ… Abertura de programas essenciais no inÃ­cio do expediente
- âœ… Controle de execuÃ§Ã£o para evitar duplicidade por perÃ­odo (manhÃ£, tarde, noite)
- âœ… Log de atividades com timestamp
- âœ… VerificaÃ§Ã£o de processos ativos para evitar mÃºltiplas execuÃ§Ãµes simultÃ¢neas
- âœ… Leitura dinÃ¢mica de programas a abrir via arquivo JSON

## ğŸ§  LÃ³gica de ExecuÃ§Ã£o

O script `everyday.py` identifica o perÃ­odo atual com base no horÃ¡rio e executa a rotina correspondente:

- **ManhÃ£ (07:00 Ã s 11:59)**: abre programas e marca o ponto
- **Tarde (12:00 Ã s 18:00)**: apenas marca o ponto
- **Noite (18:01 Ã s 22:00)**: apenas marca o ponto
- Fora desses horÃ¡rios, nenhuma aÃ§Ã£o Ã© tomada

## ğŸŒ AutomaÃ§Ã£o com Selenium

O mÃ³dulo `navegador.py` utiliza o Selenium para:

1. Abrir o navegador (Edge, Chrome ou Firefox)
2. Acessar o portal RH da empresa
3. Clicar no botÃ£o "Marcar Ponto"
4. Trocar o foco para a nova janela/modal
5. Confirmar a marcaÃ§Ã£o do ponto

Em caso de erro, o sistema registra no log e encerra o navegador com seguranÃ§a.

## ğŸ§° UtilitÃ¡rios

### helpers.py

- `log(mensagem)`: registra mensagens com timestamp no log
- `executando(nome_processo)`: verifica se um processo estÃ¡ ativo no sistema usando `psutil`

### diversos.py

- `ler_dados_json()`: lÃª os programas a abrir do arquivo `list_programs.json`
- `abrir_programa(nome_programa)`: abre o programa se nÃ£o estiver em execuÃ§Ã£o
- `abrir_todos_programas()`: executa todos os programas listados

### controle.py

- `ja_executou(periodo)`: verifica se a rotina jÃ¡ foi executada no dia
- `registrar_execucao(periodo)`: registra a execuÃ§Ã£o da rotina no controle

### config.py

- Configura o sistema de logging para registrar mensagens no arquivo `automacao.log` dentro da pasta `data`

### sms.py
- `ler_dados_json()`: carrega os dados do arquivo `sms.json` execucao da API do twilio
- `envia_sms(mensagem)`: envia mensagem de texto, via twilio, com o resultado do processamento

## ğŸš€ Como Executar

Certifique-se de que todas as dependÃªncias estejam instaladas e execute o script principal:

```bash
python everyday.py

A automaÃ§Ã£o pode ser agendada via agendador de tarefas do sistema operacional para rodar nos horÃ¡rios desejados.
ou pode-se gerar um executÃ¡vel.
ğŸ› ï¸ Tecnologias Utilizadas

Python 3.x
Selenium WebDriver
psutil
twilio
subprocess
MÃ³dulos padrÃ£o (datetime, time, json, os, logging)

ğŸ‘¤ Autor
Wanderson de Correia
Custom Software Engineering Assoc Mgr
Belo Horizonte, MG

Obs: os dados da conta do twilio e o endereÃ§o WEB do relÃ³gio foram omitidos. 
     Por ser uma aplicaÃ§Ã£o expecÃ­fica, a navegaÃ§Ã£o WEB deve ser ajustada para cada caso.